# 🔬 분말 검사 시스템 - 로컬 네트워크 버전

Google Apps Script 기반 시스템을 Python Flask로 변환한 로컬 네트워크 전용 버전입니다.

## 📋 목차

1. [필요한 것](#필요한-것)
2. [설치 방법](#설치-방법)
3. [실행 방법](#실행-방법)
4. [다른 PC에서 접속하기](#다른-pc에서-접속하기)
5. [문제 해결](#문제-해결)

---

## 필요한 것

- **Windows 11 PC** (서버용)
- **Python 3.9 이상**
- **인터넷 연결** (Python 설치 시에만 필요)

---

## 설치 방법

### 1단계: Python 설치

#### 1-1. Python 다운로드

1. 웹 브라우저를 열고 https://www.python.org/downloads/ 로 이동
2. 노란색 **"Download Python 3.x.x"** 버튼 클릭
3. 다운로드된 파일 실행

#### 1-2. Python 설치 (중요!)

설치 시 반드시 다음을 확인하세요:

1. 설치 첫 화면에서 **"Add Python to PATH"** 체크박스를 **반드시 체크**하세요!
   ```
   ☑️ Add Python to PATH  <-- 이것을 꼭 체크!
   ```

2. "Install Now" 클릭

3. 설치 완료 후 "Close" 클릭

#### 1-3. Python 설치 확인

1. **Windows 키**를 누르고 `cmd` 입력
2. **명령 프롬프트** 실행
3. 다음 명령어 입력 후 Enter:
   ```
   python --version
   ```
4. `Python 3.x.x` 라고 나오면 성공!

---

### 2단계: 프로젝트 준비

#### 2-1. 폴더 위치 선택

서버로 사용할 PC에서 원하는 위치에 `powder_inspection` 폴더를 저장하세요.

**추천 위치:**
- `C:\powder_inspection`
- `D:\powder_inspection`

#### 2-2. 명령 프롬프트로 폴더 이동

1. **Windows 키**를 누르고 `cmd` 입력
2. **명령 프롬프트** 실행
3. 다음 명령어 입력 (폴더 위치에 맞게 수정):
   ```
   cd C:\powder_inspection
   ```

**팁:** 폴더를 드래그해서 명령 프롬프트에 놓으면 경로가 자동 입력됩니다!

---

### 3단계: Python 라이브러리 설치

명령 프롬프트에서 다음 명령어를 **순서대로** 입력하세요:

```bash
pip install Flask
```

Enter를 누르고 설치 완료될 때까지 기다립니다.

```bash
pip install Flask-CORS
```

다시 Enter를 누르고 설치 완료될 때까지 기다립니다.

**설치 완료 메시지:**
```
Successfully installed Flask-3.0.0 ...
```

---

### 4단계: 데이터베이스 초기화

명령 프롬프트에서 다음 명령어 입력:

```bash
python init_db.py
```

**성공 메시지:**
```
데이터베이스 생성 중...
테이블 생성 완료!
샘플 데이터 입력 중...
샘플 데이터 입력 완료!

=== 데이터베이스 초기화 완료 ===
분말 사양: 3개
입도분석 규격: 12개
검사자: 4명

데이터베이스 파일: database.db
```

이제 `powder_inspection` 폴더에 `database.db` 파일이 생성되었습니다!

---

## 실행 방법

### 방법 1: 명령어로 실행 (추천)

1. **명령 프롬프트** 열기
2. 프로젝트 폴더로 이동:
   ```bash
   cd C:\powder_inspection
   ```
3. 서버 시작:
   ```bash
   python app.py
   ```

### 방법 2: 배치 파일로 실행 (더 간편!)

1. `start.bat` 파일을 **더블 클릭**
2. 자동으로 서버가 실행됩니다!

---

### 서버 실행 확인

서버가 정상 실행되면 다음과 같은 메시지가 나타납니다:

```
==================================================
분말 검사 시스템 서버 시작
==================================================
접속 주소: http://localhost:5000
내부 네트워크 접속: http://<이 PC의 IP>:5000
종료: Ctrl+C
==================================================
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.100:5000  <-- 이 주소를 기억하세요!
```

---

### 웹 브라우저에서 접속

1. **같은 PC에서 접속:**
   - 웹 브라우저 열기 (Chrome, Edge 등)
   - 주소창에 입력: `http://localhost:5000`

2. **다른 PC에서 접속:**
   - 아래 "다른 PC에서 접속하기" 섹션 참조

---

### 서버 종료

- 명령 프롬프트 창에서 **Ctrl + C** 를 누르면 서버가 종료됩니다.
- 배치 파일로 실행한 경우 창을 닫으면 됩니다.

---

## 다른 PC에서 접속하기

### 1단계: 서버 PC의 IP 주소 확인

#### 방법 1: 명령 프롬프트 사용

1. 서버 PC에서 **명령 프롬프트** 열기
2. 다음 명령어 입력:
   ```bash
   ipconfig
   ```
3. **IPv4 주소**를 찾으세요:
   ```
   이더넷 어댑터 이더넷:

   IPv4 주소 . . . . . . . . . : 192.168.1.100  <-- 이것!
   ```

#### 방법 2: 서버 실행 메시지 확인

서버 실행 시 나타나는 메시지에서 IP 주소를 확인:
```
 * Running on http://192.168.1.100:5000  <-- 이 주소!
```

---

### 2단계: 방화벽 설정 (중요!)

다른 PC에서 접속하려면 서버 PC의 방화벽에서 5000번 포트를 허용해야 합니다.

#### Windows 방화벽 설정 방법:

1. **Windows 키** 누르고 "방화벽" 검색
2. **고급 보안이 포함된 Windows Defender 방화벽** 실행
3. 왼쪽 메뉴에서 **인바운드 규칙** 클릭
4. 오른쪽에서 **새 규칙** 클릭
5. 다음과 같이 설정:
   - 규칙 종류: **포트**
   - 프로토콜: **TCP**
   - 특정 로컬 포트: **5000**
   - 작업: **연결 허용**
   - 프로필: 모두 체크
   - 이름: **분말검사시스템**

---

### 3단계: 직원 PC에서 접속

1. 직원 PC에서 웹 브라우저 열기
2. 주소창에 입력:
   ```
   http://192.168.1.100:5000
   ```
   (192.168.1.100 부분을 실제 서버 PC의 IP로 변경)

3. 분말 검사 시스템 화면이 나타나면 성공!

---

## 문제 해결

### ❌ "python을 인식할 수 없습니다" 오류

**원인:** Python이 설치되지 않았거나 PATH 설정이 안됨

**해결:**
1. Python을 다시 설치하되 "Add Python to PATH" 체크
2. 또는 명령 프롬프트를 다시 시작

---

### ❌ "ModuleNotFoundError: No module named 'flask'" 오류

**원인:** Flask가 설치되지 않음

**해결:**
```bash
pip install Flask Flask-CORS
```

---

### ❌ 다른 PC에서 접속 안됨

**원인:** 방화벽 또는 네트워크 문제

**해결:**
1. 방화벽 설정 확인 (위 "방화벽 설정" 참조)
2. 서버 PC와 직원 PC가 같은 네트워크에 연결되어 있는지 확인
3. IP 주소가 정확한지 확인

**네트워크 연결 테스트:**
직원 PC의 명령 프롬프트에서:
```bash
ping 192.168.1.100
```
(192.168.1.100을 실제 서버 IP로 변경)

응답이 오면 네트워크 연결 정상!

---

### ❌ "Address already in use" 오류

**원인:** 5000번 포트가 이미 사용 중

**해결:**
1. 이전에 실행한 서버를 종료
2. 또는 `app.py` 파일의 마지막 줄을 수정:
   ```python
   app.run(host='0.0.0.0', port=5001, debug=True)  # 5000 → 5001
   ```

---

## 📁 파일 구조

```
powder_inspection/
│
├── app.py                  ← 메인 서버 프로그램
├── init_db.py              ← 데이터베이스 초기화 스크립트
├── database.db             ← 데이터베이스 파일 (자동 생성)
├── requirements.txt        ← 필요한 라이브러리 목록
├── README.md               ← 이 파일
├── start.bat               ← 빠른 실행 파일 (Windows)
│
└── templates/
    └── index.html          ← 웹 화면
```

---

## 💾 백업 방법

### 중요한 파일:

- `database.db` - 모든 검사 데이터가 저장된 파일

### 백업 방법:

1. 서버를 종료합니다 (Ctrl+C)
2. `database.db` 파일을 USB나 다른 폴더에 복사
3. 정기적으로 백업하세요!

### 복원 방법:

1. 서버를 종료
2. 백업한 `database.db` 파일을 원래 위치에 복사 (덮어쓰기)
3. 서버를 다시 시작

---

## 🔧 고급 설정

### 서버 자동 시작 (Windows 부팅 시)

1. **시작 프로그램 폴더** 열기:
   - `Windows + R` 키
   - `shell:startup` 입력 후 Enter

2. `start.bat` 파일의 **바로가기**를 이 폴더에 복사

3. PC 재부팅 시 서버가 자동으로 시작됩니다!

---

### 포트 번호 변경

기본 포트 5000 대신 다른 포트를 사용하려면:

1. `app.py` 파일을 메모장으로 열기
2. 마지막 줄 수정:
   ```python
   app.run(host='0.0.0.0', port=8080, debug=True)
   ```
3. 방화벽에서도 해당 포트 허용 필요

---

## 📞 지원

문제가 해결되지 않으면:

1. 오류 메시지를 스크린샷으로 저장
2. 어떤 단계에서 문제가 발생했는지 기록
3. IT 담당자에게 문의

---

## 📝 라이선스

이 프로젝트는 내부 사용 목적으로 제작되었습니다.
